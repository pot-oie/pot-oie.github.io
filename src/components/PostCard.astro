---
// src/components/PostCard.astro
import { Image } from "astro:assets";
import FormattedDate from "./FormattedDate.astro";
import type { CollectionEntry } from "astro:content";
interface Props {
  post: CollectionEntry<"blog">;
}

const { post } = Astro.props;
const slug = post.id.replace(/\.mdx?$/, "");
---

<a
  href={`/blog/${slug}/`}
  class="group relative block py-12 border-t border-ink-300/30 first:border-t-0 transition-all duration-500 hover:pl-4"
>
  {/* 悬停时的背景图效果 (Ghost Image) */}
  {
    post.data.coverImage && (
      <div class="absolute right-0 top-1/2 -translate-y-1/2 h-[120%] w-2/3 md:w-1/2 opacity-0 group-hover:opacity-15 transition-opacity duration-700 ease-out pointer-events-none mix-blend-multiply dark:mix-blend-overlay grayscale blur-[1px] overflow-hidden select-none z-0">
        <Image
          src={post.data.coverImage}
          alt=""
          width={800}
          class="w-full h-full object-cover mask-image-gradient"
        />
      </div>
    )
  }

  {/* 内容区域 */}
  <div
    class="relative z-10 flex flex-col md:flex-row gap-4 md:items-baseline md:justify-between"
  >
    <h3
      class="text-3xl md:text-4xl font-serif font-bold text-ink-900 dark:text-zinc-100 group-hover:text-vermilion dark:group-hover:text-vermilion transition-colors duration-300"
    >
      {post.data.shortTitle || post.data.title}
    </h3>

    {/* 日期：亮色变深，暗色变浅 */}
    <div
      class="shrink-0 font-sans text-sm font-medium tracking-widest uppercase transition-colors
      text-ink-300 group-hover:text-ink-500
      dark:text-zinc-500 dark:group-hover:text-zinc-300"
    >
      <FormattedDate date={post.data.pubDate} />
    </div>
  </div>

  {/* 摘要：亮色变深，暗色变浅 */}
  <p
    class="relative z-10 mt-4 max-w-2xl text-lg leading-relaxed line-clamp-2 transition-colors duration-300
    text-ink-500 group-hover:text-ink-700
    dark:text-zinc-400 dark:group-hover:text-zinc-200"
  >
    {post.data.description}
  </p>

  {/* 装饰性箭头 */}
  <div
    class="relative z-10 mt-6 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300 text-vermilion"
  >
    <span class="text-sm font-bold tracking-widest">READ MORE &rarr;</span>
  </div>
</a>

<style>
  .mask-image-gradient {
    -webkit-mask-image: linear-gradient(to right, transparent, black 40%);
    mask-image: linear-gradient(to right, transparent, black 40%);
  }
</style>
