---
// src/layouts/MoviePost.astro
import { Image } from "astro:assets";
import type { CollectionEntry } from "astro:content";
import BaseLayout from "./BaseLayout.astro";
import FormattedDate from "../components/FormattedDate.astro";
import { Icon } from "astro-icon/components";

type Props = CollectionEntry<"movie">["data"];
const { title, coverImage, rating, viewingDate, releaseDate, shortReview } =
  Astro.props;
---

<BaseLayout title={title} description={shortReview}>
  <article class="min-h-screen flex flex-col">
    {/* --- 上半部分：海报与信息并置，注重留白 --- */}
    <section
      class="pt-20 pb-12 md:pt-32 md:pb-20 px-4 max-w-5xl mx-auto w-full grid grid-cols-1 md:grid-cols-[300px_1fr] gap-12 items-end"
    >
      {/* 海报：带阴影和黑白处理 */}
      <div class="relative group mx-auto md:mx-0 w-full max-w-[300px]">
        <div
          class="absolute -inset-2 bg-ink-900/5 rotate-2 rounded-sm pointer-events-none"
        >
        </div>
        <Image
          src={coverImage}
          alt={title}
          width={600}
          class="relative z-10 w-full aspect-2/3 object-cover rounded-sm shadow-ink filter grayscale contrast-[1.1] transition-all duration-700 group-hover:grayscale-0 group-hover:-translate-y-2"
        />
      </div>

      {/* 信息区 */}
      <div class="flex flex-col gap-6 text-center md:text-left">
        <div>
          <h1
            class="text-4xl md:text-6xl font-serif font-bold text-ink-900 mb-2"
          >
            {title}
          </h1>
          <p class="text-ink-500 font-serif text-lg italic">"{shortReview}"</p>
        </div>

        <div class="w-full h-px bg-ink-300/30"></div>

        <div
          class="flex flex-wrap justify-center md:justify-start gap-x-8 gap-y-4 text-sm tracking-widest uppercase font-sans text-ink-500"
        >
          <div class="flex flex-col gap-1">
            <span class="text-xs text-ink-300">Rating</span>
            <div
              class="flex items-center gap-1 text-vermilion text-lg font-bold font-serif"
            >
              <span>{rating.toFixed(1)}</span>
              <span class="text-xs opacity-60">/ 5.0</span>
            </div>
          </div>

          <div class="flex flex-col gap-1">
            <span class="text-xs text-ink-300">Watched On</span>
            <span class="text-ink-900"
              ><FormattedDate date={viewingDate} /></span
            >
          </div>

          {
            releaseDate && (
              <div class="flex flex-col gap-1">
                <span class="text-xs text-ink-300">Released</span>
                <span class="text-ink-900">
                  <FormattedDate date={releaseDate} />
                </span>
              </div>
            )
          }
        </div>
      </div>
    </section>

    {/* --- 下半部分：影评内容 --- */}
    {/* 如果有内容才显示分割线和容器 */}
    <section class="grow bg-white/50 border-t border-ink-300/20">
      <div class="max-w-3xl mx-auto px-4 py-16 prose prose-ink">
        <slot />
        {/* 默认占位符，如果没有内容 */}
        <div class="empty:hidden"></div>
      </div>
    </section>
  </article>
</BaseLayout>
